{"version":3,"file":"js/7636.8ad061f6aee5f3142288.js","mappings":"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","sources":["webpack:///./src/components/InventoryGroups/Modals/Modal.js","webpack:///./src/components/InventoryGroups/Modals/ModalSchemas/schemes.js","webpack:///./src/components/InventoryGroups/helpers/validate.js","webpack:///./src/components/InventoryGroups/utils/apiWithToast.js","webpack:///./src/components/InventoryTable/ActionWithRBAC.js"],"sourcesContent":["import React from 'react';\nimport { Modal } from '@patternfly/react-core';\nimport FormRenderer from '@data-driven-forms/react-form-renderer/form-renderer';\nimport FormTemplate from '@data-driven-forms/pf4-component-mapper/form-template';\nimport componentMapper from '@data-driven-forms/pf4-component-mapper/component-mapper';\nimport PropTypes from 'prop-types';\n\nconst RepoModal = ({\n  isModalOpen,\n  title,\n  titleIconVariant,\n  closeModal,\n  submitLabel,\n  schema,\n  initialValues,\n  variant,\n  reloadData,\n  reloadTimeout,\n  size,\n  onSubmit,\n  customFormTemplate,\n  additionalMappers,\n  modalClassName,\n}) => {\n  return (\n    <Modal\n      ouiaId=\"group-modal\"\n      appendTo={() =>\n        document.body.querySelector('.inventory') || document.body\n      } // required to support the app's stylesheets\n      variant={size ?? 'small'}\n      title={title}\n      titleIconVariant={titleIconVariant ?? null}\n      isOpen={isModalOpen}\n      onClose={closeModal}\n      className={modalClassName}\n    >\n      <FormRenderer\n        schema={schema}\n        FormTemplate={\n          customFormTemplate\n            ? customFormTemplate\n            : (props) => (\n                <FormTemplate\n                  {...props}\n                  submitLabel={submitLabel}\n                  disableSubmit={['invalid']}\n                  buttonsProps={{\n                    submit: { variant },\n                  }}\n                />\n              )\n        }\n        initialValues={initialValues}\n        componentMapper={\n          additionalMappers\n            ? { ...additionalMappers, ...componentMapper }\n            : componentMapper\n        }\n        //reload comes from the table and fetches fresh data\n        onSubmit={async (values) => {\n          await onSubmit(values);\n\n          if (reloadData !== undefined) {\n            if (reloadTimeout) {\n              setTimeout(async () => await reloadData(), reloadTimeout);\n            } else {\n              await reloadData();\n            }\n          }\n\n          closeModal();\n        }}\n        onCancel={() => closeModal()}\n        subscription={{ values: true }}\n      />\n    </Modal>\n  );\n};\n\nRepoModal.propTypes = {\n  isModalOpen: PropTypes.bool,\n  title: PropTypes.string,\n  closeModal: PropTypes.func,\n  reloadData: PropTypes.func,\n  submitLabel: PropTypes.string,\n  schema: PropTypes.object,\n  initialValues: PropTypes.object,\n  variant: PropTypes.string,\n  onSubmit: PropTypes.func,\n  size: PropTypes.string,\n  additionalMappers: PropTypes.object,\n  titleIconVariant: PropTypes.any,\n  customFormTemplate: PropTypes.node,\n  reloadTimeout: PropTypes.number,\n  modalClassName: PropTypes.string,\n};\n\nRepoModal.defaultProps = {\n  reloadTimeout: 500,\n};\n\nexport default RepoModal;\n","import React from 'react';\nimport validatorTypes from '@data-driven-forms/react-form-renderer/validator-types';\nimport componentTypes from '@data-driven-forms/react-form-renderer/component-types';\nimport { nameValidator } from '../../helpers/validate';\nimport { Text } from '@patternfly/react-core';\nimport awesomeDebouncePromise from 'awesome-debounce-promise';\nimport { getWritableGroups } from '../../utils/api';\n\nexport const createGroupSchema = (namePresenceValidator) => ({\n  fields: [\n    {\n      component: componentTypes.TEXT_FIELD,\n      name: 'name',\n      label: 'Group name',\n      helperText:\n        'Can only contain letters, numbers, spaces, hyphens ( - ), and underscores( _ ).',\n      isRequired: true,\n      autoFocus: true,\n      validate: [\n        // async validator has to be first in the list\n        namePresenceValidator,\n        { type: validatorTypes.REQUIRED },\n        { type: validatorTypes.MAX_LENGTH, threshold: 50 },\n        nameValidator,\n      ],\n    },\n  ],\n});\n\nexport const confirmSystemsAddSchema = (hostsNumber) => ({\n  fields: [\n    {\n      component: componentTypes.PLAIN_TEXT,\n      name: 'warning-message',\n      label: `${hostsNumber} of the systems you selected already belong to a group.\n             Moving them to a different group will impact their configuration.`,\n    },\n    {\n      component: componentTypes.CHECKBOX,\n      name: 'confirmation',\n      label: 'I acknowledge that this action cannot be undone.',\n      validate: [{ type: validatorTypes.REQUIRED }],\n    },\n  ],\n});\n\nconst createDescription = (hosts) => {\n  return (\n    <Text>\n      Select a group to add{' '}\n      <strong>\n        {hosts.length > 1 ? `${hosts.length} systems` : hosts[0].display_name}\n      </strong>{' '}\n      to, or create a new one.\n    </Text>\n  );\n};\n\n//this is a custom schema that is passed via additional mappers to the Modal component\n//it allows to create custom item types in the modal\n\nconst loadOptions = awesomeDebouncePromise(\n  async (searchValue, chrome) => {\n    const fetchedGroups = await getWritableGroups(\n      searchValue,\n      { page: 1, per_page: 100 }, // TODO: make the list paginated\n      () => chrome.getUserPermissions('inventory')\n    );\n\n    return fetchedGroups.map(({ name, id }) => ({\n      label: name,\n      value: JSON.stringify({ id, name }), // stringify is a workaround for https://github.com/data-driven-forms/react-forms/issues/1401\n    }));\n  },\n  250,\n  { onlyResolvesLast: false }\n);\n\nexport const addHostSchema = (hosts, chrome) => ({\n  fields: [\n    {\n      component: componentTypes.PLAIN_TEXT,\n      name: 'description',\n      label: createDescription(hosts),\n    },\n    {\n      component: 'select',\n      name: 'group',\n      label: 'Select a group',\n      simpleValue: true,\n      isSearchable: true, // enables typeahead\n      isRequired: true,\n      isClearable: true,\n      placeholder: 'Type or click to select a group',\n      loadOptions: (searchValue) => loadOptions(searchValue, chrome),\n      options: [],\n      validate: [{ type: validatorTypes.REQUIRED }],\n      updatingMessage: 'Loading groups...',\n      loadingMessage: 'Loading groups...',\n    },\n    {\n      component: 'create-group-btn',\n      name: 'create-group-btn',\n      isRequired: true,\n    },\n  ],\n});\n","import validatorTypes from '@data-driven-forms/react-form-renderer/validator-types';\n\nexport const nameValidator = {\n  type: validatorTypes.PATTERN,\n  pattern: /^[A-Za-z0-9]+[A-Za-z0-9_\\-\\s]*$/,\n  message:\n    'Name must start with alphanumeric characters and can contain underscore and hyphen characters.',\n};\n","import { addNotification } from '@redhat-cloud-services/frontend-components-notifications/redux';\n\nconst apiWithToast = (dispatch, api, statusMessages) => {\n  const hasSuccess = statusMessages?.onSuccess;\n  const hasInfo = statusMessages?.onInfo;\n\n  if (!statusMessages) {\n    statusMessages = {\n      onSuccess: {\n        title: 'Success',\n        description: 'The request has been made successfully',\n      },\n      onError: {\n        title: 'Error',\n        description: 'An error occurred making the request',\n      },\n    };\n  }\n\n  const fetchData = async () => {\n    try {\n      const response = await api();\n      hasInfo &&\n        dispatch({\n          ...addNotification({\n            variant: 'info',\n            ...statusMessages.onInfo,\n          }),\n        });\n      hasSuccess &&\n        dispatch({\n          ...addNotification({\n            variant: 'success',\n            ...statusMessages.onSuccess,\n          }),\n        });\n      return response;\n    } catch (err) {\n      dispatch({\n        ...addNotification({\n          variant: 'danger',\n          ...statusMessages.onError,\n          // Add error message from API, if present\n          description: err?.Title\n            ? `${statusMessages.onError.description}: ${err.Title}`\n            : statusMessages.onError.description,\n        }),\n      });\n      return err;\n    }\n  };\n\n  return fetchData();\n};\n\nexport default apiWithToast;\n","/**\n * This module contains Button and DropdownItem components wrapped by RBAC checks.\n *\n * The permissions are checked _only_ within the Inventory app context.\n */\nimport React from 'react';\nimport { usePermissionsWithContext } from '@redhat-cloud-services/frontend-components-utilities/RBACHook';\nimport { Button, DropdownItem, Tooltip } from '@patternfly/react-core';\nimport PropTypes from 'prop-types';\n\nexport const ActionButton = ({\n  requiredPermissions,\n  noAccessTooltip,\n  checkAll,\n  override,\n  ignoreResourceDefinitions,\n  ...props\n}) => {\n  const { hasAccess: enabled } =\n    override !== undefined\n      ? { hasAccess: override }\n      : usePermissionsWithContext(\n          requiredPermissions,\n          checkAll,\n          !ignoreResourceDefinitions\n        );\n\n  return enabled ? (\n    <Button {...props} />\n  ) : (\n    <Tooltip content={noAccessTooltip}>\n      <Button {...props} isAriaDisabled />\n    </Tooltip>\n  );\n};\n\nActionButton.propTypes = {\n  requiredPermissions: PropTypes.array,\n  noAccessTooltip: PropTypes.string,\n  checkAll: PropTypes.bool,\n  override: PropTypes.bool,\n  ignoreResourceDefinitions: PropTypes.bool,\n};\n\nActionButton.defaultProps = {\n  checkAll: false,\n};\n\nexport const ActionDropdownItem = ({\n  requiredPermissions,\n  noAccessTooltip,\n  checkAll,\n  override,\n  ignoreResourceDefinitions,\n  ...props\n}) => {\n  const { hasAccess: enabled } =\n    override !== undefined\n      ? { hasAccess: override }\n      : usePermissionsWithContext(\n          requiredPermissions,\n          checkAll,\n          !ignoreResourceDefinitions\n        );\n\n  return enabled ? (\n    <DropdownItem {...props} />\n  ) : (\n    <DropdownItem {...props} isAriaDisabled tooltip={noAccessTooltip} />\n  );\n};\n\nActionDropdownItem.propTypes = {\n  requiredPermissions: PropTypes.array,\n  noAccessTooltip: PropTypes.string,\n  checkAll: PropTypes.bool,\n  override: PropTypes.bool,\n  ignoreResourceDefinitions: PropTypes.bool,\n};\n\nActionDropdownItem.defaultProps = {\n  checkAll: false,\n};\n"],"names":["i","RepoModal","isModalOpen","title","titleIconVariant","closeModal","submitLabel","schema","initialValues","variant","reloadData","reloadTimeout","size","onSubmit","customFormTemplate","additionalMappers","modalClassName","ouiaId","appendTo","document","body","querySelector","isOpen","onClose","className","FormTemplate","props","disableSubmit","buttonsProps","submit","componentMapper","values","undefined","setTimeout","onCancel","subscription","propTypes","PropTypes","defaultProps","createGroupSchema","namePresenceValidator","fields","component","componentTypes","TEXT_FIELD","name","label","helperText","isRequired","autoFocus","validate","type","validatorTypes","REQUIRED","MAX_LENGTH","threshold","nameValidator","confirmSystemsAddSchema","hostsNumber","PLAIN_TEXT","CHECKBOX","createDescription","hosts","length","display_name","loadOptions","awesomeDebouncePromise","searchValue","chrome","getWritableGroups","page","per_page","getUserPermissions","fetchedGroups","map","id","value","JSON","stringify","onlyResolvesLast","addHostSchema","simpleValue","isSearchable","isClearable","placeholder","options","updatingMessage","loadingMessage","PATTERN","pattern","message","dispatch","api","statusMessages","hasSuccess","onSuccess","hasInfo","onInfo","description","onError","fetchData","response","addNotification","Title","ActionButton","requiredPermissions","noAccessTooltip","checkAll","override","ignoreResourceDefinitions","hasAccess","usePermissionsWithContext","content","isAriaDisabled","ActionDropdownItem","tooltip"],"sourceRoot":""}