(self.webpackChunkinsights_inventory_frontend=self.webpackChunkinsights_inventory_frontend||[]).push([[149],{25149:(e,t,n)=>{"use strict";n.r(t),n.d(t,{calculatePagination:()=>H,default:()=>q});var r=n(67154),i=n.n(r),a=n(59713),l=n.n(a),o=n(63038),s=n.n(o),c=n(80150),u=n.n(c),d=n(45697),f=n.n(d),p=n(70983),m=(n(92920),n(45514)),g=n(68433),v=n(44510),h=n(14018),y=n(84804),b=n(50693),E=n(16475),O=n(75061),F=n(20787),_=n(80236),w=n(79851),N=n(34512),P=n(49739),S=n(83826),A=n(48140),C=n(86050),T=n(47173),k=n(99239),R=n(69957),j=function(e){var t,n=e.handleModalToggle,r=e.isModalOpen,i=e.currentSytem,a=e.onConfirm,l="system";return Array.isArray(i)?(t=1===i.length?i[0].display_name:"".concat(i.length," systems"),l=1===i.length?l:"systems"):t=i.displayName,u().createElement(_.u,{variant:"small",title:"Remove from inventory",className:"ins-c-inventory__table--remove",isOpen:r,onClose:function(){return n(!1)}},u().createElement(w.P,{hasGutter:!0},u().createElement(N.J,null,u().createElement(R.ZP,{size:"xl",className:"ins-m-alert"})),u().createElement(N.J,{isFilled:!0},u().createElement(P.K,{hasGutter:!0},u().createElement(S.v,null,t," will be removed from all ",location.host," applications and services. You need to re-register the ",l," to add it back to your inventory."),u().createElement(S.v,null,"To disable the daily upload for this ",l,", use the following command:"),u().createElement(S.v,null,u().createElement(k.M5,null,"insights-client --unregister"))))),u().createElement(A.a,{hasGutter:!0},u().createElement(C.Z,null,u().createElement(T.zx,{variant:"danger",onClick:a},"Remove"),u().createElement(T.zx,{variant:"link",onClick:function(){return n(!1)}},"Cancel"))))},D=f().shape({id:f().string,displayName:f().string});j.propTypes={isModalOpen:f().bool,currentSytem:f().oneOfType([D,f().arrayOf(D)]),handleModalToggle:f().func,onConfirm:f().func},j.defaultProps={isModalOpen:!1,currentSytem:{},handleModalToggle:function(){},onConfirm:function(){}};const I=j;var M=n(14040),L=n(94654),W=n.n(L),G=[{staleFilter:["fresh","stale"]},{registeredWithFilter:["insights"]}],x=function(e){return!e||0===(null==e?void 0:e.length)},z=function(e,t,n,r){return[!x(e)&&{staleFilter:Array.isArray(e)?e:[e]},!x(n)&&{tagFilters:Array.isArray(n)?n:[n]},!x(t)&&{registeredWithFilter:Array.isArray(t)?t:[t]},!x(r)&&{value:"hostname_or_id",filter:Array.isArray(r)?r[0]:r},(!x(e)||!x(n)||!x(r))&&x(t)&&{registeredWithFilter:[]},(!x(t)||!x(n)||!x(r))&&x(e)&&{staleFilter:[]}].filter(Boolean)},B=n(58135);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.every((function(e){var n=e.id;return t&&t.has(n)}))?e.length>0:e.some((function(e){var n=e.id;return t&&t.has(n)}))&&null},K=function(e){var t=e.category;return e.values.map((function(e){var n=e.tagKey,r=e.value;return"".concat(t?"".concat(t,"/"):"").concat(n).concat(r?"=".concat(r):"")}))},U={staleFilter:function(e,t){return e.staleFilter.forEach((function(e){return t.append("status",e)}))},registeredWithFilter:function(e,t){var n=e.registeredWithFilter;return null==n?void 0:n.forEach((function(e){return t.append("source",e)}))},value:function(e,t){var n=e.value,r=e.filter;return"hostname_or_id"===n&&Boolean(r)&&t.append("hostname_or_id",r)},tagFilters:function(e,t){var n=e.tagFilters;return(null==n?void 0:n.length)>0&&t.append("tags",W()(n,K))}},H=function(e,t,n){var r=new URLSearchParams(location.search),i=void 0!==t?t:r.get("page"),a=void 0!==n?n:r.get("per_page");!isNaN(parseInt(i))&&e.append("page",i),!isNaN(parseInt(a))&&e.append("per_page",a)},V=function(e){var t=e.clearNotifications,n=e.deleteEntity,r=e.addNotification,a=e.loaded,l=e.rows,o=e.updateDisplayName,d=e.onSelectRows,f=e.selected,m=e.status,y=e.setFilter,F=e.history,_=e.source,w=e.filterbyName,N=e.tagsFilter,P=e.page,S=e.perPage,A=e.setPagination;document.title="Inventory | Red Hat Insights";var C=(0,c.useRef)(null),T=(0,c.useState)(!1),k=s()(T,2),R=k[0],j=k[1],D=(0,c.useState)({}),L=s()(D,2),W=L[0],x=L[1],J=(0,c.useState)([]),K=s()(J,2),V=K[0],q=K[1],$=(0,c.useState)(!1),Q=s()($,2),X=Q[0],ee=Q[1],te=(0,c.useState)(),ne=s()(te,2),re=ne[0],ie=ne[1],ae=(0,p.useSelector)((function(e){var t=e.permissionsReducer;return{loading:null==t?void 0:t.loading,writePermissions:null==t?void 0:t.writePermissions}}),p.shallowEqual),le=ae.loading,oe=ae.writePermissions,se=function(e,t){(null==e?void 0:e.filters)||(e.filters=G);var n=null==e?void 0:e.filters.reduce((function(e,t){return Y(Y(Y(Y(Y({},e),(null==t?void 0:t.staleFilter)&&{status:t.staleFilter}),(null==t?void 0:t.registeredWithFilter)&&{source:t.registeredWithFilter}),(null==t?void 0:t.tagFilters)&&{tagsFilter:t.tagFilters}),"hostname_or_id"===(null==t?void 0:t.value)&&{filterbyName:t.filter})}),{status:void 0,source:void 0,tagsFilter:void 0,filterbyName:void 0}),r=n.status,i=n.source,a=n.tagsFilter,l=n.filterbyName;e.filters=z(r,i,a,l),q(null==e?void 0:e.filters);var o=new URLSearchParams;!function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(t){Object.keys(t).forEach((function(n){var r;null==U||null===(r=U[n])||void 0===r||r.call(U,t,e)}))}))}(o,null==e?void 0:e.filters),H(o,null==e?void 0:e.page,null==e?void 0:e.per_page);var s=o.toString();F.push({search:s,hash:location.hash}),!t&&C&&C.current?C.current.onRefreshData(e):t&&t(e)};(0,c.useEffect)((function(){var e,n;null===(e=insights.chrome)||void 0===e||null===(n=e.hideGlobalFilter)||void 0===n||n.call(e,!1),insights.chrome.appAction("system-list"),insights.chrome.appObjectId(),insights.chrome.on("GLOBAL_FILTER_UPDATE",(function(e){var t,n,r,i,a=e.data,l=null===(t=insights.chrome)||void 0===t||null===(n=t.mapGlobalFilter)||void 0===n?void 0:n.call(t,a,!1,!0),o=s()(l,3),c=o[0],u=o[1],d=o[2];ie({tags:d,filter:Y(Y({},null==re?void 0:re.filter),{},{system_profile:Y(Y(Y({},null==re||null===(r=re.filter)||void 0===r?void 0:r.system_profile),(null==c||null===(i=c.SAP)||void 0===i?void 0:i.isSelected)&&{sap_system:!0}),(null==u?void 0:u.length)>0&&{sap_sids:u})})}),C.current&&C.current.onRefreshData({})})),t()}),[]);var ce=function(){return f?f.size:0};return u().createElement(u().Fragment,null,u().createElement(g.m,{className:"pf-m-light"},u().createElement(g.B,{title:"Inventory"})),u().createElement(v.o,null,u().createElement(b.r,{gutter:"md"},u().createElement(E.P,{span:12},!le&&u().createElement(B.e_,i()({customFilters:re,isFullView:!0,ref:C,showTags:!0,onRefresh:se,hasCheckbox:oe},oe&&{actions:[{title:"Delete",onClick:function(e,t,n){var r=n.id,i=n.display_name;x((function(){return{id:r,displayName:i}})),j((function(){return!0}))}},{title:"Edit",onClick:function(e,t,n){x((function(){return n})),ee((function(){return!0}))}}],actionsConfig:{actions:[{label:"Delete",props:{isDisabled:0===ce(),variant:"secondary",onClick:function(){x(Array.from(f.values())),j(!0)}}}]},bulkSelect:{count:ce(),items:[{title:"Select none (0)",onClick:function(){d(-1,!1)}},Y({},a&&l&&l.length>0?{title:"Select page (".concat(l.length,")"),onClick:function(){d(0,!0)}}:{})],checked:Z(l,f),onSelect:function(e){d(0,e)}}},{tableProps:{canSelectAll:!1},onRowClick:function(e,t,n){return F.push("/".concat(t).concat(n?"/".concat(n):""))},onLoad:function(e){var t=e.mergeWithEntities,n=e.INVENTORY_ACTION_TYPES;(0,O.JH)().register(Y({},t((0,h.zw)(n)))),y(z(m,_,N,w)),(S||P)&&A(Array.isArray(P)?P[0]:P,Array.isArray(S)?S[0]:S)}}))))),u().createElement(I,{handleModalToggle:j,isModalOpen:R,currentSytem:W,onConfirm:function(){var e,t;Array.isArray(W)?(t=W.map((function(e){return e.id})),e=W.length>1?"".concat(W.length," systems"):W[0].display_name):(e=W.displayName,t=[W.id]),r({id:"remove-initiated",variant:"warning",title:"Delete operation initiated",description:"Removal of ".concat(e," started."),dismissable:!1}),n(t,e,(function(){return se({filters:V})})),j(!1)}}),u().createElement(M.Z,{title:"Edit display name",isOpen:X,value:W.display_name,onCancel:function(){return ee(!1)},onSubmit:function(e){o(W.id,e,C.current.onRefreshData),ee(!1)}}))};V.contextTypes={store:f().object},V.propTypes={rows:f().arrayOf(f().shape({id:f().string,selected:f().bool})),loaded:f().bool,loadEntity:f().func,clearNotifications:f().func,deleteEntity:f().func,addNotification:f().func,updateDisplayName:f().func,onSelectRows:f().func,setFilter:f().func,selected:f().object,status:f().oneOfType([f().arrayOf(f().string),f().string]),source:f().oneOfType([f().arrayOf(f().string),f().string]),filterbyName:f().string,tagsFilter:f().any,history:f().shape({push:f().func}),page:f().oneOfType([f().string,f().number]),perPage:f().oneOfType([f().string,f().number]),setPagination:f().func};const q=(0,m.Z)((0,p.connect)((function(e){var t=e.entities;return{rows:t&&t.rows,loaded:t&&t.loaded,selected:t&&t.selected}}),(function(e){var t=function(e,t){return e.payload.then(t),e};return{loadEntity:function(t){return e(y.A_(t))},clearNotifications:function(){return e(y.L1())},deleteEntity:function(n,r,i){return e(t(y.Ks(n,r),i))},addNotification:function(t){return e((0,F.wN)(t))},updateDisplayName:function(n,r,i){return e(t(y.$Y(n,r),i))},onSelectRows:function(t,n){return e(y.CL(t,n))},setFilter:function(t){return(null==t?void 0:t.length)>0&&e(y.Tv(t))},setPagination:function(t,n){return e(y.Jr(t,n))}}}))(V))}}]);
//# sourceMappingURL=149.ab0b1580c0484a41c2b2.js.map